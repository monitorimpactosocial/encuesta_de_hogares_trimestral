<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard EPHC │ Paracel - Monitor de Impacto Social</title>
    <meta name="description"
        content="Tablero interactivo del mercado laboral paraguayo basado en datos de la Encuesta Permanente de Hogares Continua (EPHC) del INE. Desarrollado por Paracel S.A.">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@600;700;800&display=swap"
        rel="stylesheet">
    <!-- Chart.js + Datalabels -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <!-- Crossfilter -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter2/1.5.4/crossfilter.min.js"></script>
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <link rel="stylesheet" href="css/estilos.css">
</head>

<body>

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand">
            <div class="brand-logo">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="url(#g1)" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M2 17L12 22L22 17" stroke="url(#g1)" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M2 12L12 17L22 12" stroke="url(#g1)" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <defs>
                        <linearGradient id="g1" x1="2" y1="2" x2="22" y2="22" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#34D399" />
                            <stop offset="1" stop-color="#3B82F6" />
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <div>
                <div class="brand-name">EPHC Dashboard</div>
                <div class="brand-sub">Monitor Social Paracel</div>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="section-label">PERIODO</div>
            <div class="filter-group">
                <select id="trimestre-select" class="filter-select">
                    <option value="ALL">Histórico Completo</option>
                </select>
                <div class="filter-hint">Configura el corte temporal global</div>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="section-label">GÉNERO</div>
            <div class="toggle-group" id="filter-sexo">
                <button class="toggle-btn active" data-val="ALL">
                    <span class="toggle-icon">⟐</span> Todos
                </button>
                <button class="toggle-btn" data-val="Hombres">
                    <span class="toggle-icon">♂</span> Hombres
                </button>
                <button class="toggle-btn" data-val="Mujeres">
                    <span class="toggle-icon">♀</span> Mujeres
                </button>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="section-label">TRAMO DE EDAD</div>
            <div class="age-chips" id="filter-edad">
                <button class="age-chip active" data-val="ALL">Todos</button>
                <button class="age-chip" data-val="15-24">15–24</button>
                <button class="age-chip" data-val="25-34">25–34</button>
                <button class="age-chip" data-val="35-44">35–44</button>
                <button class="age-chip" data-val="45-54">45–54</button>
                <button class="age-chip" data-val="55-64">55–64</button>
                <button class="age-chip" data-val="65+">65+</button>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="section-label">DEPARTAMENTO</div>
            <div class="filter-group">
                <select id="dpto-select" class="filter-select">
                    <option value="ALL">Todo el País</option>
                </select>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="section-label">CATEGORÍA OCUPACIONAL</div>
            <div class="filter-group">
                <select id="cate-select" class="filter-select">
                    <option value="ALL">Todas las Categorías</option>
                    <option value="Obrero privado">Obrero privado</option>
                    <option value="Obrero público">Obrero público</option>
                    <option value="Cuenta propia">Cuenta propia</option>
                    <option value="Empleador/patrón">Empleador/patrón</option>
                    <option value="Doméstico/a">Trabajador/a Doméstico/a</option>
                </select>
            </div>
        </div>

        <div class="sidebar-footer">
            <button id="btn-reset-filters" class="btn-reset">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                    <path d="M3 3v5h5" />
                </svg>
                Resetear Filtros
            </button>
            <div class="data-source">Fuente: INE – EPHC 2015-2025</div>
        </div>
    </aside>

    <!-- ===== MAIN APP ===== -->
    <div class="app-main" id="app-main">

        <!-- Top Bar -->
        <header class="topbar">
            <button class="sidebar-toggle" id="sidebar-toggle">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <line x1="3" y1="6" x2="21" y2="6" />
                    <line x1="3" y1="12" x2="21" y2="12" />
                    <line x1="3" y1="18" x2="21" y2="18" />
                </svg>
            </button>
            <div class="topbar-title">
                <span id="tab-current-name">Demografía</span>
                <span class="breadcrumb">│ EPHC Trimestral</span>
            </div>
            <div class="topbar-meta">
                <a href="../" class="topbar-back-link" title="Volver al Tablero Principal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="13" height="13">
                        <polyline points="15 18 9 12 15 6" />
                    </svg>
                    Tablero Principal
                </a>
                <span class="live-badge">
                    <span class="pulse-dot"></span> En Vivo
                </span>
                <span class="meta-label">Dataset EPHC 2015–2025</span>
            </div>
        </header>

        <!-- ===== TAB NAVIGATION ===== -->
        <nav class="tab-nav">
            <button class="tab-nav-btn active" data-target="tab-demografia">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
                Demografía
            </button>
            <button class="tab-nav-btn" data-target="tab-educacion">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                </svg>
                Educación
            </button>
            <button class="tab-nav-btn" data-target="tab-salud">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                </svg>
                Salud
            </button>
            <button class="tab-nav-btn" data-target="tab-laboral">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <rect x="2" y="7" width="20" height="14" rx="2" />
                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
                </svg>
                Mercado Laboral
            </button>
            <button class="tab-nav-btn" data-target="tab-evolucion">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                </svg>
                Series Históricas
            </button>
        </nav>

        <!-- ===== CONTENT ===== -->
        <div class="content-area">

            <!-- TAB 1: DEMOGRAFÍA -->
            <section id="tab-demografia" class="tab-pane active">
                <div class="kpi-row">
                    <div class="kpi-card accent-emerald">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                <circle cx="9" cy="7" r="4" />
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Población PET Filtrada</div>
                            <div class="kpi-value" id="kpi-pob-total">—</div>
                        </div>
                    </div>
                    <div class="kpi-card accent-blue">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" />
                                <path d="M12 16v-4" />
                                <path d="M12 8h.01" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Rango de Edad Mayoritario</div>
                            <div class="kpi-value kpi-text" id="kpi-edad-mayor">—</div>
                        </div>
                    </div>
                    <div class="kpi-card accent-purple">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                                <polyline points="9 22 9 12 15 12 15 22" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Depto. Mayoritario</div>
                            <div class="kpi-value kpi-text" id="kpi-dpto-mayor">—</div>
                        </div>
                    </div>
                </div>
                <div class="charts-3col">
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Distribución por Sexo</h3>
                            <span class="chart-badge">PET</span>
                        </div>
                        <div class="chart-body">
                            <canvas id="sexoChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Distribución por Edad</h3>
                            <span class="chart-badge">PET</span>
                        </div>
                        <div class="chart-body">
                            <canvas id="edadChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Por Departamento</h3>
                            <span class="chart-badge">Top 10</span>
                        </div>
                        <div class="chart-body">
                            <canvas id="dptoChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="map-section">
                    <div class="chart-card map-card">
                        <div class="chart-card-header">
                            <h3>Mapa de Distribución Geográfica – Población en Edad de Trabajar</h3>
                            <span class="chart-badge map-badge">Mapa Interactivo</span>
                        </div>
                        <div id="map-demografia" class="leaflet-map"></div>
                        <div class="map-legend" id="legend-demo">
                            <div class="legend-title">Personas PET</div>
                            <div class="legend-items">
                                <div class="legend-item"><span style="background:#047857"></span>> 300.000</div>
                                <div class="legend-item"><span style="background:#10b981"></span>100–300K</div>
                                <div class="legend-item"><span style="background:#34d399"></span>50–100K</div>
                                <div class="legend-item"><span style="background:#6ee7b7"></span>20–50K</div>
                                <div class="legend-item"><span style="background:#a7f3d0"></span>
                                    < 20.000</div>
                                </div>
                            </div>
                        </div>
                    </div>
            </section>

            <!-- TAB 2: EDUCACIÓN -->
            <section id="tab-educacion" class="tab-pane">
                <div class="kpi-row">
                    <div class="kpi-card accent-purple">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Promedio Años de Estudio</div>
                            <div class="kpi-value" id="kpi-anios-estudio">—</div>
                        </div>
                    </div>
                </div>
                <div class="charts-full">
                    <div class="chart-card wide">
                        <div class="chart-card-header">
                            <h3>Promedio de Años de Estudio por Tramo de Edad</h3>
                            <span class="chart-badge">Ponderado por PET</span>
                        </div>
                        <div class="chart-body chart-tall">
                            <canvas id="educacionEdadChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB 3: SALUD -->
            <section id="tab-salud" class="tab-pane">
                <div class="kpi-row">
                    <div class="kpi-card accent-teal">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Cobertura IPS</div>
                            <div class="kpi-value" id="kpi-ips">— %</div>
                            <div class="kpi-sub">De los ocupados filtrados</div>
                        </div>
                    </div>
                    <div class="kpi-card accent-orange">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Aporte Jubilación</div>
                            <div class="kpi-value" id="kpi-jubilacion">— %</div>
                            <div class="kpi-sub">De los ocupados filtrados</div>
                        </div>
                    </div>
                </div>
                <div class="charts-2col">
                    <div class="chart-card wide">
                        <div class="chart-card-header">
                            <h3>Cobertura IPS y Jubilación por Categoría Ocupacional</h3>
                            <span class="chart-badge">% sobre ocupados</span>
                        </div>
                        <div class="chart-body chart-tall">
                            <canvas id="saludCateChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Proporción General IPS</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="saludDonutChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB 4: MERCADO LABORAL -->
            <section id="tab-laboral" class="tab-pane">
                <div class="kpi-row kpi-4col">
                    <div class="kpi-card accent-blue">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                <circle cx="9" cy="7" r="4" />
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Tasa Fuerza Trabajo (TFT)</div>
                            <div class="kpi-value" id="kpi-tft">— %</div>
                            <div class="kpi-sub" id="poblacion-ref-lab">Ref: — PET</div>
                        </div>
                    </div>
                    <div class="kpi-card accent-emerald">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" />
                                <path d="M16 12l-4 4-4-4" />
                                <path d="M12 8v8" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Tasa de Ocupación</div>
                            <div class="kpi-value" id="kpi-ocupacion">— %</div>
                        </div>
                    </div>
                    <div class="kpi-card accent-red">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" />
                                <line x1="15" y1="9" x2="9" y2="15" />
                                <line x1="9" y1="9" x2="15" y2="15" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Tasa de Desocupación</div>
                            <div class="kpi-value" id="kpi-desocupacion">— %</div>
                        </div>
                    </div>
                    <div class="kpi-card accent-yellow">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <rect x="2" y="7" width="20" height="14" rx="2" />
                                <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Categoria Ocupacional</div>
                            <div class="kpi-value kpi-text" id="kpi-top-cate">—</div>
                        </div>
                    </div>
                </div>
                <div class="charts-2col">
                    <div class="chart-card wide">
                        <div class="chart-card-header">
                            <h3>Distribución de Ocupados por Categoría</h3>
                            <span class="chart-badge">Ponderado</span>
                        </div>
                        <div class="chart-body chart-tall">
                            <canvas id="cateOcupacionChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Ocupados vs Desocupados</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="ocuDesocDonutChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="map-section">
                    <div class="chart-card map-card">
                        <div class="chart-card-header">
                            <h3>Mapa de Tasa de Fuerza de Trabajo por Departamento</h3>
                            <span class="chart-badge map-badge">Mapa Interactivo</span>
                        </div>
                        <div id="map-laboral" class="leaflet-map"></div>
                        <div class="map-legend" id="legend-lab">
                            <div class="legend-title">TFT (%)</div>
                            <div class="legend-items">
                                <div class="legend-item"><span style="background:#1d4ed8"></span>> 70%</div>
                                <div class="legend-item"><span style="background:#2563eb"></span>65–70%</div>
                                <div class="legend-item"><span style="background:#3b82f6"></span>60–65%</div>
                                <div class="legend-item"><span style="background:#60a5fa"></span>55–60%</div>
                                <div class="legend-item"><span style="background:#93c5fd"></span>
                                    < 55%</div>
                                </div>
                            </div>
                        </div>
                    </div>
            </section>

            <!-- TAB 5: SERIES HISTÓRICAS + SML -->
            <section id="tab-evolucion" class="tab-pane">
                <div class="kpi-row">
                    <div class="kpi-card accent-emerald">
                        <div class="kpi-icon-wrap">
                            <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                            </svg>
                        </div>
                        <div class="kpi-body">
                            <div class="kpi-label">Obreros Priv. Superan SML</div>
                            <div class="kpi-value" id="kpi-supera-sml">— %</div>
                            <div class="kpi-sub positive">Condición Favorable</div>
                        </div>
                    </div>
                </div>
                <div class="charts-2col">
                    <div class="chart-card wide">
                        <div class="chart-card-header">
                            <h3>Evolución Histórica: Tasas de Ocupación y Desocupación</h3>
                            <span class="chart-badge">Serie 2015–2025</span>
                        </div>
                        <div class="chart-body chart-tall">
                            <canvas id="evolucionLaboralChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Cobertura IPS y Jubilación en el Tiempo</h3>
                        </div>
                        <div class="chart-body chart-tall">
                            <canvas id="evolucionSaludChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="chart-card stacked-section">
                    <div class="chart-card-header">
                        <h3>Distribución de Obreros Privados vs. Salario Mínimo Legal – Serie 2015–2025</h3>
                        <span class="chart-badge">SML Histórico Anualizado</span>
                    </div>
                    <div class="chart-body chart-xl">
                        <canvas id="smlEvolucionChart"></canvas>
                    </div>
                </div>
                <div class="charts-2col">
                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Distribución Actual vs. SML</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="smlDonutChart"></canvas>
                        </div>
                    </div>
                    <div class="kpi-card accent-blue info-card">
                        <div class="info-title">Sobre el SML Histórico</div>
                        <ul class="info-list">
                            <li>Valores anualizados según resoluciones del MTE Paraguay.</li>
                            <li>El umbral ±10% permite clasificar en "1 SML".</li>
                            <li>Aplica solo a <strong>Obreros Privados</strong> con ingreso declarado.</li>
                            <li>Los filtros de la barra lateral afectan todos los gráficos.</li>
                        </ul>
                    </div>
                </div>
            </section>

        </div><!-- /content-area -->
    </div><!-- /app-main -->

    <script src="js/app.js"></script>
</body>

</html>